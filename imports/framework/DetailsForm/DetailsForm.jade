template(name="DetailsForm")
  +DetailsFormNavigation data=data.navigation

  form.form-horizontal

    if isLoading
      .loading
        i.fa.fa-circle-o-notch.fa-spin.fa-3x

    else if noResult
      .center-align
        h2 Oops!
        p We couldn't find anything.
        button#back.btn.btn-primary {{_ 'navigation.back'}}

    else
      each section in sections

        if isType section 'header'
          +DetailsFormHeader section=section entity=getItem
        else
          .section

            if section.title
              .section-title {{getSectionTranslation section.title}}

            if section.contents
              .section-content.clearfix

                each field in section.contents
                  if hasPermissionToSee field

                    if isType field 'array'
                      .array(key='{{field.key}}')

                        if isEmptyArray field
                          p.noElements {{getNoElementsTranslation field.item}}

                        else if isType field.item 'entity'
                          each item in getValue field getItem
                            +DetailsFormArrayEntity definition=field.item entity=item

                        else if isType field.item 'dropdown'
                          each item in getValue field getItem
                            +DetailsFormArrayDropdown definition=field.item entity=item

                        else if isKeyValue field.item
                          each entity in getValue field
                            h1 FIELD.item
                            .input.form-group.array-item(key='{{getKey field.item}}' clickType='{{field.item.click.type}}' clickMethod='{{field.item.click.method}}' clickLink='{{field.item.click.link}}' entityId='{{entity._id}}')
                              .key {{entity.key}}
                              .value
                                | {{entity.value}}
                                if isType field.item 'delete'
                                  i.fa.fa-trash.icon
                                else
                                  i.fa.fa-angle-right.icon
                        else
                          each entity in getValue field
                            h1 ELSE
                            .input.form-group.array-item(key='{{getKey field.item}}' clickType='{{field.item.click.type}}' clickMethod='{{field.item.click.method}}' clickLink='{{field.item.click.link}}' entityId='{{entity._id}}')
                              .key
                                if field.item.icon
                                  i.material-icons {{field.item.icon}}
                                | {{getProperty entity field.item}}
                              .value
                                if isType field.item 'delete'
                                  i.fa.fa-trash.icon
                                else
                                  i.fa.fa-angle-right.icon

                    else if isType field 'phone'
                      +DetailsFormPhone definition=field entity=getItem

                    else if isType field 'email'
                      +DetailsFormEmail definition=field entity=getItem

                    else if isType field 'text'
                      +DetailsFormText definition=field entity=getItem

                    else if isType field 'textbox'
                      +DetailsFormTextbox definition=field entity=getItem

                    else if isType field 'date'
                      +DetailsFormDate definition=field entity=getItem

                    else if isType field 'link'
                      +DetailsFormLink definition=field entity=getItem

                    else if isType field 'dropdown'
                      +DetailsFormDropdown definition=field entity=getItem

                    else if isType field 'checkbox'
                      +DetailsFormCheckbox definition=field entity=getItem

                    else
                      h1 Unsupported form type

            +DetailsFormActions actions=section.actions
